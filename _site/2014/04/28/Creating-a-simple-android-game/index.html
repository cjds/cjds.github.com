<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="/stylesheets/app.css">
	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab:300' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Playfair+Display' rel='stylesheet' type='text/css'>
	<script type="text/javascript" href="/js/foundation.min.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>

	<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?autoload=false"></script>
		<link href='/css/prettify.css' rel='stylesheet' type='text/css'>
	<title>Creating a Simple Android Game</title>
	<link href='http://fonts.googleapis.com/css?family=Lora' rel='stylesheet' type='text/css'>


  


</head>
<style>
@import url(http://fonts.googleapis.com/css?family=Roboto+Slab:100);


@font-face {
    font-family: Mohave;
    src: url('/fonts/Mohave.otf');
}

ol li{
 	font-family: "Lora","Helvetica",Arial,sans-serif;
 	font-size: 1.1em;
 	color:#222;
 }

 ul li{
 	font-family: "Lora","Helvetica",Arial,sans-serif;
 	font-size: 1.1em;
 	color:#222;
 }
 p{
 	font-family: "Lora","Helvetica",Arial,sans-serif;
 	font-size: 1.1em;
 	color:#222;
 	text-align:justify;
 	margin-top:10px;
 	margin-bottom: 20px;
 }



.body-code{
	position: absolute;
	bottom: 0;
	top:40px;
	width:100%;
}
.fun-heading {
	height:100%;

	margin-top: 0px;
/*	box-shadow: -10px 0px 5px 0px rgba(0, 0, 0, 0.2);;*/

}

hr { 
	display: block; height: 1px;
    border: 0; border-top: 1px solid #000;
    margin: 1em 0; padding: 0; opacity: 0.2;}

.fun-heading ul {
	margin-left: 0;
}
.fun-heading ul a li{
	text-align: left;
	font-family: 'Verdana',sans-serif;
	font-weight: 500;
	font-size: 1em;
	line-height: 2em;
	list-style: none;
	color: #666;
	margin: 10px;
}
.fun-heading ul a:hover{
	text-decoration: underline;
}

.fun-heading h1{
	font-family: 'Roboto Slab',serif;
	font-weight: 100;
	font-size: 3.5em;	
	color: #000;
	opacity: 0.3;
	margin-top: -0.1em;
}

 h1,h2,h3,h4,h5,h6{
 	font-weight: 900;
 }

 h1{
 	margin-top: 1rem;
 }

h2{
	font-size: 1.6em;
}

h3{
	font-size: 1.4em;
}


 hr{
 	margin:0px;
 	margin-bottom: 5px;
 }


.top-bar{
	background-color:#fff;
	color:#000;
}

.top-bar .name h1 a{
	color:#333;
	font-family:Mohave;
	font-size: 1.4rem;
}


.top-bar .name h1 a:hover{
	color:#b22;
}


.top-bar .right li a{
	background: #fff;
	color:#333;
	font-family:Mohave;
	font-size: 1.4rem;
}

.top-bar-section li:not(.has-form) a:not(.button){
	background: #fff;
}

.top-bar .right li a:hover{
	text-decoration:underline;
}
.top-bar .toggle-topbar.menu-icon a{
	color:#333;
}


/*
.top-bar{
	background-color:#fff;
	position: absolute;
	top:0;
	box-shadow: 0px 2px 5px 5px rgba(0, 0, 0, 0.2);
	z-index: 2;
	width: 100%;
	height:40px;
}
 .top-bar >ul >li >h1 > a{
 	font-weight: 900 !important;
 	color:#000 !important;

 }

 code{
 	overflow: auto;

 	font-family: "Verdana","Helvetica",Arial,sans-serif;
 	color:#555;
	background-color: #eee;
	padding:0px 4px 3px 4px;
	letter-spacing: 1px;
	line-height: 130%;
	word-spacing: 2px;
	margin: 4px;
	font-weight: normal;
	font-size: 0.9em;
 }

 pre code{
 	padding:0px;
	margin: 0px;
	word-wrap: initial;
	background:none !important;
	
 }

pre{
	background-color: #eee;
	border-left:solid 5px #f00000 !important;
	padding:6px;
	margin: 6px;
	overflow-x:auto;
	overflow-y: hidden;
 }
*/

pre{
	background-color: #333;
	padding:2px;
	margin: 2px;
	overflow-x:auto;
	overflow-y: hidden;
 }

 .big img{
 border-top: solid 1px #ccc;
 width:100%;
 	margin: 0px auto;
 	box-shadow: 0px 5px 5px #aaa;
 }

 .image img{
 	margin: 10px auto 30px;
 	display: block;
 }

 .image p{
	margin: 0px auto;
 }

 .caption p{
 	margin: 0px auto;
 	display: block;
 	font-size: 0.8em;
 	text-align: center;
 	margin-bottom: 25px;
 }


 .post-div{
 	padding: 25px;
 	margin-top: 50px;
 	border-top: solid 1px #ccc;
 box-shadow: 0px 5px 5px #ccc;	
 }

 .post-div > h1{
 	margin-top: 10px;
 	margin-bottom: 1px;
 	font-family: 'Mohave';
 	text-align: center;
 	font-weight: 300

 }
</style>
<body>

<nav class="top-bar" data-topbar >
  <ul class="title-area">
    <li class="name">
      <h1><a href="http://carlsaldanha.com" style='text-align:left' >Carl Saldanha</a></h1>
    </li>
        <li class="toggle-topbar" style='font-family:Mohave'><a href="#"></a></li>

  </ul>

  <section class="top-bar-section">
    
    <ul class="right">

      <li><a href="http://carlsaldanha.com/resume">Resume</a></li>
      <li><a href="http://carlsaldanha.com/projects">Projects</a></li>

      <li><a href="http://cjds.github.io/">Blog</a></li>
      </li>
    </ul>

  </section>
</nav>
<div class='large-6 large-offset-3 medium-8 medium-offset-2 small-12 post-div'>
<h1>Creating a Simple Android Game</h1>

<hr>
<p>Recently, I have started programming in Android again after nearly a 3 year break. I thought I would start by creating a simple game and making it into a tutorial. Instead of delving into the logic of any particular game I'm just giving the outline code of what it takes to make a game.</p>

<h2>1. The basics behind making a game</h2>

<p>Android consists of pages called Acitvities. An Activity represents one user interface and one significant portion of logic. For example, a simple game can be into 3 major activities</p>

<ol>
<li>The opening Activity consisting of the logo and maybe a play button and settings</li>
<li>The game itself</li>
<li>The end-game activity consisting of a replay button and score</li>
</ol>


<p>All of these activities will contain components called Views inside. Views can be anything from a textbox to a button. A group of views make up an activity.</p>

<p>For the opening and end-game activity we will use some of these simple views like Buttons and Images.</p>

<p>For the actual game activity however we're going to need to create our own custom view (for most games at least).
This custom view will act like a blank Canvas. We keep drawing the entire game layout on the Canvas and refreshing at the appropriate moments.</p>

<p>Before we start on the opening or end-game activities lets focus on the game activity and custom view.</p>

<h2>2. Building the Game Activity and Custom View</h2>

<p>Assuming you have android up and running create a new Android project in Eclipse</p>

<h3>2.0 Create a New Android Project</h3>

<p>Click File > New Android Application Project</p>

<div class="image"><p><img src="http://cjds.github.io//assets/2014-04-28/new%20project.png" alt="" /></p></div>

<p>Click Next and then Finish.
You should have a basic android project up and running.</p>

<p>Now we have to build our game Activity will come in 3 components</p>

<ol>
<li>Building the Custom View</li>
<li>Building the XML for the Activity</li>
<li>Building the Activity itself</li>
</ol>


<h3>2.1Building the Custom View</h3>

<p>Building a Custom view is done by simply extending the <code>View</code> class in android. The <code>View</code> class contains one method that must be specified called <code>onDraw(Canvas c)</code>. When this method is called the view will be drawn on the Canvas. (The canvas is an empty element that covers the area specified in your XML).</p>

<p>Games, however continually update their Canvas. This will be controlled by a method called <code>invalidate</code>. When <code>invalidate</code> is run on the view, the <code>onDraw</code> method is rerun. Thus if we keep calling <code>invalidate</code> according to a Frame Rate we can create a game that runs as fast as that fram rate.</p>

<p>(this code will however be done in the activity. I specified the theory here.)</p>

<p>So now lets go about building our View.</p>

<p>We'll start by creating a class called GameBoard which extends the view class. Then create a constructor and override the views <code>onDraw</code> method.</p>

<pre><code>class GameBoard extends View{
    public GameBoard(Context context, AttributeSet aSet) {
        super(context, aSet);
    }


    @Override
    public void onDraw(Canvas canvas){

    }
}
</code></pre>

<p>The <code>onDraw</code> method will be the key to drawing here. We will draw on the canvas passed to the method and that will be seen on the screen.</p>

<pre><code>boolean init=false;
int time =0;
@Override
public void onDraw(Canvas canvas){
        if(!init){
            init=true;
        }
        else{
            drawBackground(canvas);
            boolean bringForward=false;
            time++;
            addTextAnimation(canvas);
        }

}
</code></pre>

<h3>2.2Building the XML for the Activity</h3>

<p>Well for the game activity we'll create our own <code>activity.xml</code></p>

<p>This basically will contain any layout (I've used a LinearLayout but it doesn't matter as the View takes up the whole screen) and a XML element of our custom view (inside the package you require). You see we've put a drawable background on the view.</p>

<pre><code>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" &gt;

&lt;com.cjds.GameBoard
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="@drawable/back"
            android:id="@+id/the_canvas"/&gt;
&lt;/LinearLayout&gt;
</code></pre>

<h3>2.3 Building the Activity Itself</h3>

<p>To build the Activity we make a use of a <code>Handler</code>. <code>Handler</code> is basically an extension of the <code>Thread</code> class which can call a bit of code after some milliseconds (in the <code>postDelayed</code> method). We use this class to call the views <code>onDraw</code> method repeatedly.</p>

<p>To handle clicks we use an <code>onTouchListener</code> that we create using an anonymous class. You can override any <code>MotionEvent</code> and pass it to the appropriate method in the view. We built the <code>handleClick</code> method for that very purpose.</p>

<pre><code>public class Dactyl extends Activity{

    public Handler frame = new Handler();
    private static final int FRAME_RATE = 40; //25 frames per second
    private GameBoard canvas;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dactyl);

        sharedPref = this.getSharedPreferences("settings",Context.MODE_PRIVATE);
        Handler h = new Handler();
        canvas=(GameBoard)findViewById(R.id.the_canvas);

                canvas.setOnTouchListener(new OnTouchListener(){
        @Override
        public boolean onTouch(View v, MotionEvent me) {
            if(running){
                switch(me.getActionMasked()){
                    case MotionEvent.ACTION_DOWN:
                    case MotionEvent.ACTION_POINTER_DOWN: 
                        ((GameBoard)v).handleClick(me.getX(),me.getY());
                        return true;
                }
            }       
            return false;
        }

    });


        h.postDelayed(new Runnable() {
            @Override
            public void run() {
                    initGfx();
            }
        }, 1000);
    }

    synchronized public void initGfx() {
            frame.removeCallbacks(frameUpdate);
            frame.postDelayed(frameUpdate, FRAME_RATE);
    }



    public Runnable frameUpdate = new Runnable() {
        @Override
        synchronized public void run() {
            running=true;
            frame.removeCallbacks(frameUpdate);
            //make Updates here
            //then invoke the onDraw by invalidating the canvas
            canvas.invalidate();
            frame.postDelayed(frameUpdate, FRAME_RATE);
        }
    };


    public void end(){
        Intent i= new Intent(context,EndGame.class);
        i.putExtra("score", score);
        startActivity(i);  
    }


    @Override
    public void finish(){
        frame.removeCallbacks(frameUpdate);
        super.finish();
    }       
}
</code></pre>

<hr>
<i>28 Apr 2014 </i>
</div>
<script src="/js/foundation/foundation.js"></script>
  <script src="/js/foundation/foundation.topbar.js"></script>

  <script>
    $(document).foundation();
  </script>
  
<script type='text/javascript'>
$( document ).ready(function(){


  // Add pretty print to all pre and code tags.
  $('pre, code').addClass("prettyprint");

  // Remove prettify from code tags inside pre tags.
  $('pre code').removeClass("prettyprint");

  // Activate pretty presentation.
  prettyPrint();
});
</script>
</body>
</html>